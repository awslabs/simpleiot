"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CDKTimestream = void 0;
/* Â© 2022 Amazon Web Services, Inc. or its affiliates. All Rights Reserved.
 *
 * SimpleIOT project.
 * Author: Ramin Firoozye (framin@amazon.com)
*/
const cdk = require("aws-cdk-lib");
const ts = require("aws-cdk-lib/aws-timestream");
const common_1 = require("./common");
const path = require("path");
class CDKTimestream extends cdk.NestedStack {
    constructor(scope, id, props) {
        super(scope, id);
        common_1.Common.addTags(this, props.tags);
        this.databaseName = props.prefix + "_timestream_db";
        this.timestreamDatabase = new ts.CfnDatabase(this, "timestream_db", {
            databaseName: this.databaseName
        });
        this.tableName = props.prefix + "_timestream_table";
        this.timestreamIoTTable = new ts.CfnTable(this, "timestream_table", {
            databaseName: this.databaseName,
            tableName: this.tableName
        });
        // NOTE: the timestream table needs to wait until the timestream database has been created.
        //
        this.timestreamIoTTable.addDependency(this.timestreamDatabase);
    }
}
exports.CDKTimestream = CDKTimestream;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2RrX3RpbWVzdHJlYW0uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJjZGtfdGltZXN0cmVhbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQTs7OztFQUlFO0FBQ0YsbUNBQW1DO0FBSW5DLGlEQUFpRDtBQUNqRCxxQ0FBZ0M7QUFDaEMsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFFLE1BQU0sQ0FBRSxDQUFBO0FBUzlCLE1BQWEsYUFBYyxTQUFRLEdBQUcsQ0FBQyxXQUFXO0lBTzlDLFlBQVksS0FBZ0IsRUFDaEIsRUFBVSxFQUFFLEtBQXVCO1FBRTNDLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDakIsZUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFBO1FBRWhDLElBQUksQ0FBQyxZQUFZLEdBQUcsS0FBSyxDQUFDLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQztRQUVwRCxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxFQUFFLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxlQUFlLEVBQUU7WUFDaEUsWUFBWSxFQUFFLElBQUksQ0FBQyxZQUFZO1NBQ2xDLENBQUMsQ0FBQTtRQUVGLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDLE1BQU0sR0FBRyxtQkFBbUIsQ0FBQTtRQUVuRCxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxFQUFFLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxrQkFBa0IsRUFBRTtZQUNoRSxZQUFZLEVBQUUsSUFBSSxDQUFDLFlBQVk7WUFDL0IsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTO1NBQzVCLENBQUMsQ0FBQztRQUVILDJGQUEyRjtRQUMzRixFQUFFO1FBQ0YsSUFBSSxDQUFDLGtCQUFrQixDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztJQUNuRSxDQUFDO0NBQ0o7QUE5QkQsc0NBOEJDIiwic291cmNlc0NvbnRlbnQiOlsiLyogwqkgMjAyMiBBbWF6b24gV2ViIFNlcnZpY2VzLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIFNpbXBsZUlPVCBwcm9qZWN0LlxuICogQXV0aG9yOiBSYW1pbiBGaXJvb3p5ZSAoZnJhbWluQGFtYXpvbi5jb20pXG4qL1xuaW1wb3J0ICogYXMgY2RrIGZyb20gJ2F3cy1jZGstbGliJztcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnO1xuaW1wb3J0IGlhbSA9IHJlcXVpcmUoJ2F3cy1jZGstbGliL2F3cy1pYW0nKVxuXG5pbXBvcnQgdHMgPSByZXF1aXJlKCdhd3MtY2RrLWxpYi9hd3MtdGltZXN0cmVhbScpXG5pbXBvcnQge0NvbW1vbn0gZnJvbSBcIi4vY29tbW9uXCI7XG5jb25zdCBwYXRoID0gcmVxdWlyZSggXCJwYXRoXCIgKVxuXG5pbnRlcmZhY2UgSVRpbWVzdHJlYW1Qcm9wcyBleHRlbmRzIGNkay5OZXN0ZWRTdGFja1Byb3BzIHtcbiAgICBwcmVmaXggOiBzdHJpbmcsXG4gICAgdXVpZDogc3RyaW5nLFxuICAgIHN0YWdlOiBzdHJpbmcsXG4gICAgdGFnczoge1tuYW1lOiBzdHJpbmddOiBhbnl9XG59XG5cbmV4cG9ydCBjbGFzcyBDREtUaW1lc3RyZWFtIGV4dGVuZHMgY2RrLk5lc3RlZFN0YWNrIHtcblxuICAgIHB1YmxpYyB0aW1lc3RyZWFtRGF0YWJhc2U6IHRzLkNmbkRhdGFiYXNlO1xuICAgIHB1YmxpYyB0aW1lc3RyZWFtSW9UVGFibGU6IHRzLkNmblRhYmxlO1xuICAgIHB1YmxpYyBkYXRhYmFzZU5hbWU6IHN0cmluZztcbiAgICBwdWJsaWMgdGFibGVOYW1lOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcihzY29wZTogQ29uc3RydWN0LFxuICAgICAgICAgICAgICAgIGlkOiBzdHJpbmcsIHByb3BzOiBJVGltZXN0cmVhbVByb3BzKVxuICAgIHtcbiAgICAgICAgc3VwZXIoc2NvcGUsIGlkKTtcbiAgICAgICAgQ29tbW9uLmFkZFRhZ3ModGhpcywgcHJvcHMudGFncylcblxuICAgICAgICB0aGlzLmRhdGFiYXNlTmFtZSA9IHByb3BzLnByZWZpeCArIFwiX3RpbWVzdHJlYW1fZGJcIjtcblxuICAgICAgICB0aGlzLnRpbWVzdHJlYW1EYXRhYmFzZSA9IG5ldyB0cy5DZm5EYXRhYmFzZSh0aGlzLCBcInRpbWVzdHJlYW1fZGJcIiwge1xuICAgICAgICAgICAgZGF0YWJhc2VOYW1lOiB0aGlzLmRhdGFiYXNlTmFtZVxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMudGFibGVOYW1lID0gcHJvcHMucHJlZml4ICsgXCJfdGltZXN0cmVhbV90YWJsZVwiXG5cbiAgICAgICAgdGhpcy50aW1lc3RyZWFtSW9UVGFibGUgPSBuZXcgdHMuQ2ZuVGFibGUodGhpcywgXCJ0aW1lc3RyZWFtX3RhYmxlXCIsIHtcbiAgICAgICAgICAgIGRhdGFiYXNlTmFtZTogdGhpcy5kYXRhYmFzZU5hbWUsXG4gICAgICAgICAgICB0YWJsZU5hbWU6IHRoaXMudGFibGVOYW1lXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIE5PVEU6IHRoZSB0aW1lc3RyZWFtIHRhYmxlIG5lZWRzIHRvIHdhaXQgdW50aWwgdGhlIHRpbWVzdHJlYW0gZGF0YWJhc2UgaGFzIGJlZW4gY3JlYXRlZC5cbiAgICAgICAgLy9cbiAgICAgICAgdGhpcy50aW1lc3RyZWFtSW9UVGFibGUuYWRkRGVwZW5kZW5jeSh0aGlzLnRpbWVzdHJlYW1EYXRhYmFzZSk7XG4gICAgfVxufVxuIl19